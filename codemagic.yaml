workflows:
  default-workflow:
    name: Default Workflow
    max_build_duration: 60
    environment:
      vars:
        FIREBASE_ANDROID: Encrypted(Z0FBQUFBQmZ6VmgxRldCaXBxaUduamRjenJkMzRNX296c2VuNVZlV1FXSFBYelFMblRJTUgtcUZoUExLcWZqUjlVNTRpM0J0Zl9UejBZdkNGSDRNcjAxRFY1Qkp4bDBhYWxVUWZqQktha3NxbzZmQkpIUXNCVWZRcXFRajIzZDRTTXdGTDJldzZmd2VtR1ZPOE9KTllvQjdjRFVkWVpqVWpud1FhNnZHc0tlaDZOLURxZXdnWDhHNnJFUmV0S2k4eUJHdVVhLTdZNXBFTWpZbWxwdGVkVkdKSVZDOXhKV3BBbWozSDBmN3J2aEtrN2NxZkZ6RGJfZjU4NDNVeS1EOFlKUU0tR0tRQzE5N0hoaGlDOHJ0LTk5ang1bEpJQk5WVUdJWEc2a2VvMmd4eG4wUjREa21sQkNOSXd0cXZ6SU5lX3Vxd3pSRWlBNXRrMmdPUUlYekxha2dPY2x4ZmZGZnJfOE9EQ1dDV1hoVGFVZkJHZW43UkczMTJ2TVVxNk1jOE5jdmVZU3hNaFQyaHRzR19oTUNHX0xHRGdfYXZnUkpjVHAwQVZxWUJlR1BKQlpPakFNTDhIYVdMVzM2TU83MTRhY3ozRW1ZWTd6Umx0c2U2QjRTakpJcUtROFhCdE51UXlSN05yUVFLV0R3M3JzTmZuN1puNzdyVUNhYnYyTTJVd1lQSks0R0FBbWxmQXZxeWpLSjRMc3NSNWFjOVE4X0M0MGNKamRJdS1hekdoVDd3Tm1fTmVwRnVrV3licjdaN1JKMTE3Wk9mNjBxb1JuWGJUZ3I0Y0ZPN21URXlQam95eFdsQkoweUlaX0F2R2hpMUp2ZE1TMldtU2w4NTJ0M3h5b1ZSbmtoVi15WTc1Q0JhRmNRQ2lneC1kdU9uekktaWxjaENHLXZkdkRrLXlZLUtMdjJ2bmQwMmVUa0dxVmxmUG1jM1FZR1h0TlZ4MWJWVXhpRUlZTXgwbXZ1dXA2ZURheEVuejM4aVdWc0Y2S0pOSFVLZ1VZZFJqLVk1Vm81WWh3N09yekRVd1lFY0dYMzAwOFgtTHU3WjlpR29XMDNJWjdSZW8wM1ZTanJld19FM1FIZXowaWxKNUItS1V3QzN5NjBJejNabnNTTGhTTFVpcHdBMUNUYnpjZVdKV1V6bHk3SXZiNDQxOXBkWkZtcVNmbDMzbTR3eGt0Y0xwREJRVzdQWGpjMEdhTWdwYUVibk9nZVoySlZ6ZnJOY0docGg2T1NxV25XRW5xT1A3NGpBMmtfXzU0d1NiSFJyM1N6NW1SNVJsYmZqOWY1V0NxNHlCQ25EZWNhTV96eFdiWlFYMDFvMFB4UllzendhcUlDTF9oSXg0THVJNVFneXlCSHBYNVNTMlE0UXRXYnB5WEc5WG5ac001Njh3NVYyR1pMWW13TUxtakVLVDR6allldVBsM2I2VkViWFVMQnB3V0FVX2FqTnhXRkV6U2FkczYxYmdWc2RCZjFhOFhjZW9qLVhYTXlPaWdZZ1dBeFFvNkp1N0RIQnFXb1M5dWhQUEJ2Q2tKbnlxMk13MGJ3Y3ZiRldRWXBmdU1qYVdsb0x3T29KQk5jQVJYRHZROEczZ1ZpalB4UHZjZUdpSkhCVVRjSVpYV0FFbFg0WGlEZkZzcTdmal9HTUFZd1NRNkVkWkc4ZGxZVUdCQ2k4YW5NT2NoaFAtSHZDdzJNZXlneTZHR2p1MnJyaVFiZ1V3WXY1SlIteTNMSWNDbzBVbXFkYS0xaWtzWnp0V1BSd1Z0NHhQb1kzRVpCRVBqY3RDczM5NldnUDhSNVdNT2JNNkRkUFlvekhoUU1VTWhSbjBESzJMZWduMnhPOXNHUzRveTJ0eE54Vk9mQzBDMzgtcXJ0YUpSanZ4LUVpdk8wQ1VhSFpUNlE3TGM0NTNIQWNESkRFSHBRZFYtY0xMNHhJbkdVYUVsU3V2OE1MTmtoZ1BGUnhEVzFLMjh1TmdEOFFSUmM1UHBmQmRnMjBhdUFXWm03SGZ0SjNzbU9RWTR6UTgzVlhEaTNzOVA3TGkyM2Y3aHhXU3p3OENQeEw2QThjaFRXUVo2aDFPTzVINkdsUUZTdHk1VnZHQ05fdHc2Q0lCYTN1TGdDYUVCbVNrVXJIbE15LWNwb1BVWUlIUGRSbk0wc2dNRkViRTRlejNfUjdJU3J6dkEzQzYteHVraFdGLVJUSGRqWFhReTV2TFg2SGJZd1lTN3FvYjBRNHBxcGRDc3paRlFyam1PQnp6cVZOZEFlbHdUV2ZhSVhJZXJLemZ6WEVrVXVrQXU1NlhKTTlwU3MwclpWRGczOTVrdkVDalpMbWtSNy1ORHhwbnhqck1WZTB5T015QmFvSUk2UVowdWpFbHFDSk5oV01oLUJqVGFseXVuSmJHUElZVHZxY3haRGpkM21abmZHMTFaY2hvWFRKOFZ0eVBMMmstSUd1dW9kZXRjY0F3ZlA3ZWtEZXMzWjNGTS1jSFhJX3duT0Y0MEpqeUdtUkNmMnNuell5TVFzcEZ0OFJ0R1BiUTlGWEM4QnA4OHVZdHlCSzdETHNKZzRzM2hVVXE1MW4tZ0RMcmwwdEs3a1hfaGFvdDVFaXk5VUZlTVZuRDVoWi1rZFZQeU8yUzE0d0t0N3NVdWdhejhSdUxVWHJHbjNnNVJudW9BcXB5dF9oNTQ4U29Xa1ozR2RGZ2N1MHc9PQ==)
        FIREBASE_IOS: Encrypted(Z0FBQUFBQmZ6VmUwdV9lTjN1VUF6QklsYVZoNUtWNlZGVGxXc3ZhTXZjSk9mLXUtSEhVMjJVUjlHX0RMelNEaWlEY2JTWXU2VE4za0o0dVFhd19rWmhHY3RTSjFTX2tFbi1MbDNZWVF4VUhIcjdSM1ZYRWk5QW0zR1lBeVJfbmhpZGNtam4wOWVGZU0wLXNiNGRhOE1tWHFPTEZlNTM1OFJzWWpQc3FBTVc3NFpDSUNidTBsTDJFNjB6QVd4Tm5kWjQzT1A2OW5XX2FWOHVIeThqQnZfem5ydmdodHZnNzNRdW9RMkU3UjVXektGSVVKRG04eDBNLXFBVFY5V2xfSEtlWUNLdU5GU3JobF8zTHlfTU9ybUJ0NHd5OXpiN0Z0a3JBUnRMQ2gtMldyYXNDMXdUVkVEeWd5UWI4bmNkTkp6T0xZZlJ1MVg4WlRhY3gwYldDNlpOY2h3Ny1BdS1rM2JsNGQ5bGkzNjc1dkpNdWxwYi1MM3ZCVWhjOU5oTDhoX1ZabmVCYWNTYzVLa1dnd3R4aWl6RjhpV1plQ3JrdGlCWjZvdXJ3eTFsak9KemprSFRXWmxISXVjLVRDUHN3bDJxNDVQMjRiY0xpLTB3aEU0dUR5Q0tyVmJmelFic2dYOVdMZ0ZaeTU2TjhGb0hvV0Z4TzFrS3QyaXlCQnZMX0ZXeUpKLW9HYzFKdl9teFNNRXRMYXpSVlVMNFFncF90eUdGLTNDb0gwUTRHYmhIY2hoZF9EVzRDR3ppNENlLVJueUF3VF9odFl4WWdEQjBGZXB4a0ZiZ0tvN0RDNlhHdkV2UjUxcjcwYjMyblotM1NLc0d2R2V2eE15NlFsbVh5R0pleTljXzh1OTJrZ3ZGaHlQelFTbktXTTI1NlJSOU9oNmpLTmJUbzYzZDB0UktEVWxuNUp6STV3TGkxYlNHLVJZaVJRSHVjc0dJalhyVGVXU0tSMG5Gbl9CdTYzOFo2cG14bEttTGk3X3hvN0ZPSDdFOTFpZ1dKY050S25DUjhOVmFsSHdUN1VreHZsYWZ0VE9VNE9wajRneUF6bGtsZ0lNeUNIVnAzZWxyZXdoYzZPdW9HRzhNQzJaNkFGWTNkRktfczZSU1lwNVdHMk5OVVZuQTVKNE90RUdUZkVFTUFQcHBLTV9wYTRmUEdMeDExMVVZYTF5Q2FGUFBxMEJTcXZjcjVmTFFoZnBJQ1h5eFNvSjZETHppSXJCNEV5WGRPa0tIdTBuOEJXZy1jT2Y2NXR4Y0p6b21yMzNIRlIzUGlXazVMSjh4dlItRWcxQzF5a21fenVxclcyMWNtX3djYjVnVEROejhWSWh4Q3J3SkNmVG9VdVZ1VnpNWkFoekFnWjZPVGE5UldUM0UxLWlvU2VFbW9tM0toR1dLWFNvUE1lRDczZnNHUHRpRTBnMllfT2RLVl85VWtLNmQ0cXNpSlpJR3VxYTlhQzFTYks2WWpSMFdPYnpEeWoxQ2lFZE1wUG9GOEpSWk0zeDNfRDJTWnFTN0JORklaZnV2TXM5cDlBaEtxdjlUVzlBSDlQdkU2MFE1TmFyVC14ZjJ1YmJRMEoyMnAtZS1IWWFlWm9JbWFaUVJUMndwZXFRRWdEZWhJRHRJRW05dTNId3ZRMWpBSWhhUFViaUdMbUcxdkUyZmxnLXhhQ3RLSFpDelpObUdFZlBwbU1GaHl6Z0kxTk1tV1NnTHBiNnNmZ0JPSGdjcTlxbzB5YmdXNHlZTUpRNGswWGRCUHhwUFVJWUJQZ3h4R1BVa0h3SE5mT091WHJ3R3VwZ3lUT1VuaGVWN0xHOW5FQ1p6SVVETGhYSF9TcnRmTk5rZ2I0bHJMLUR3bzVoZE1XR3I2UEpfYkNlWjk4MWpubnBvSjVETmdFUHdrVThJUjhqR0ZTcEVlYS1LdGdmUmdaaGxFM3AteFZ6RnJiMzRLZ3A3OFZ3VzM3SXBZSmhRT1ROMWlqTDhxQjB2eE1UWGZWdjR3dll0a0tIV004MUpyRVNsQ2sxWDJYUWlxanJ5RVctclZYbGNnaHUyVkt5OTY4Q2F5eTUzeU1VSmVUcnFHSnVFN1R6RTM4SVljTDREQWhUNmZlaFpZSmdmWG1nX2RORHNaR1lxNWFXa3Bua0FlbEFPN0tzVHhrN3JkUXRRU2M1dU1XeC1HWksyNWI2U2RENjBjTFJhQ3EyX1JOc1ZjYlg2eVBSTmpLYnRMcWNDM1ROaG9HM2pHVjNZOXpXb1ZWdFEyQW5lYnVpRFJqNHFhVElQVjJzY1BLdXJxdEk0alkwRm9yZDF5ZHk2ajE3Vk02MmI2dDh0TG1KREkzdTQ5Y244Q1pPMFNueU1IbEdYRV85UzhkV01tblppSGlXbkN0dDhXcEZXYUFYSWs1VlVNV1Y2QWN3dHQtVTNrcWxwSDVybVJ4dDltSzh3TTEwQU9KSFpEMVNhNFFKR3NYd3hlVFNlTXRkLVZ6NTBWVnM1T1dLVkM4bXpZWEZuWFdxcG5BX0d4MG1zbFpQRXRnZjFobmFpVXZHSlFkdTlEWi1qQllJV2ZDYWRwellwQi1RTldrYW9RaFVrRUZoZXRKdEVsOVpyMEtjOW5Tb240YmpXN2pVelV5OHJJMl9RLUYzU3FHVVY1UFVrek5INkVaSENkV3NmRmhWbXl3NXV5SllVTmNDdHVvaXJGcWxMb1JvQjhwVk01ZGlmRVk5UW90UE5pY18yRU1KSnpIUW1kSWZKd1QtN0YxSXEwcWYzSmVVVFVOTEJrczItbE5wU29BMUZyY0hUYUVaaU5kQWljRHQ1VFJHR05naXVqbGVGWmkyclVfbDVZV1VncVpwaGVXQ0ZyODlVWncwbjd1Q1hyNE50MU5TTkV4LUl4M0NhMXJwZEJ2NFk2Xy00Yl94RXY2QzJGUk1MTVZWZVNzQ1hld01DVkdpQ0N5UllReVh1VVZZMlBxMDA0VzJrMXF4clhmUmMxQlU0NjNSR0Y0aW9KWnZ1MHZNVTY5enBaWHQtcG4=)
      flutter: beta
      xcode: latest
      cocoapods: default
    cache:
      cache_paths:
        - $HOME/Library/Caches/CocoaPods
        - $HOME/.gradle/caches
        - $FLUTTER_ROOT/.pub-cache
    scripts:
      - |
        # set up debug keystore
        rm -f ~/.android/debug.keystore
        keytool -genkeypair \
          -alias androiddebugkey \
          -keypass android \
          -keystore ~/.android/debug.keystore \
          -storepass android \
          -dname 'CN=Android Debug,O=Android,C=US' \
          -keyalg 'RSA' \
          -keysize 2048 \
          -validity 10000
      - |
        # set up local properties
        echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - cd . && flutter packages pub get
      - cd . && flutter config --enable-web
      - cd . && flutter test
      - |
        #!/bin/sh

        echo $FIREBASE_IOS | base64 --decode > $FCI_BUILD_DIR/ios/Runner/GoogleService-Info.plist
        echo "\nListing iOS Directory to confirm the GoogleService-Info.plist is there!"
        ls $FCI_BUILD_DIR/ios/Runner/

        echo $FIREBASE_ANDROID | base64 --decode > $FCI_BUILD_DIR/android/app/google-services.json
        echo "\nListing Android Directory to confirm the google-services.json is there!"
        ls $FCI_BUILD_DIR/android/app
      - cd . && flutter build apk --release
      - find . -name "Podfile" -execdir pod install \;
      - cd . && flutter build ios --release --no-codesign
      - |
        # build web
        cd .
        flutter build web --release
        cd build/web
        7z a -r ../web.zip ./*
    artifacts:
      - build/**/outputs/**/*.apk
      - build/**/outputs/**/*.aab
      - build/**/outputs/**/mapping.txt
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
      - build/web.zip
      - flutter_drive.log
    publishing:
      email:
        recipients:
          - schlereth@websight.de
